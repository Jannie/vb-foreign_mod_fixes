Original by hurik: http://www.vbulletin.org/forum/showthread.php?t=133366

Fixed for vB4:
http://www.vbulletin.org/forum/showpost.php?p=1927052&postcount=57
